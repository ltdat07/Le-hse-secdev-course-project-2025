# Study Notes — Security & Reliability NFR

> Формат строки: `ID | Название | Описание | Метрика/Порог | Проверка (чем/где) | Компонент | Приоритет`

| ID     | Название                          | Описание                                                                 | Метрика/Порог                                   | Проверка (чем/где)                | Компонент | Приоритет |
|--------|-----------------------------------|--------------------------------------------------------------------------|-------------------------------------------------|-----------------------------------|-----------|-----------|
| NFR-01 | Хранение паролей (Argon2id)       | Хеширование только Argon2id с параметрами стойкости                      | t≥3, m≥256MB, p=1                               | unit-тест конфигурации            | auth      | High      |
| NFR-02 | Политика JWT                      | Короткоживущие токены, безопасные алгоритмы, ротация ключей              | TTL ≤ 15 мин; alg=HS256/RS256; kid-ротация ≤ 30д| контракт-тест + ревью конфигов    | auth      | High      |
| NFR-03 | Защита логина                     | Ограничение попыток и rate-limit                                         | ≤ 5 неусп. логинов/мин/учётку; 429 при превыш.  | e2e + нагрузочный тест            | auth      | High      |
| NFR-04 | PII и логи                        | Маскирование e-mail/PII в логах, correlation_id во всех ответах          | 100% эндпоинтов возвращают `X-Request-ID`; PII не пишем | контракт-тест + линтер логов | api       | Medium    |
| NFR-05 | Производительность /notes (p95)   | В ответ на список заметок сервис укладывается под порог                  | p95 GET /notes ≤ 200 ms @ 20 RPS (stage)        | простой нагрузочный тест          | api       | Medium    |
| NFR-06 | Ошибки и формат RFC7807           | Единый формат ошибок без утечки деталей                                  | 100% ошибок → application/problem+json          | контракт-тесты                    | api       | Medium    |
| NFR-07 | SCA уязвимости                    | High/Critical в зависимостях устраняются быстро                           | срок устранения ≤ 7 дней                        | отчёт CI (pip-audit/OSV)          | build     | High      |
| NFR-08 | Лимиты контента                   | Ограничение размера заметки и числа тегов                                 | body ≤ 50 KB; ≤ 10 тегов/заметку                | юнит-тест валидации схем          | domain    | Medium    |
| NFR-09 | Экспорт/импорт Markdown           | Контроль размера и количества элементов                                   | экспорт ≤ 5 MB; импорт ≤ 500 заметок за раз     | e2e-тест импорта/экспорта         | domain    | Medium    |
| NFR-10 | Доступность (stage/dev)           | Базовый SLA на стендах                                                    | ≥ 99.5% (месячно)                               | аптайм-чекер/health-пинг          | ops       | Medium    |
| NFR-11 | Таймауты внешних операций         | Единые таймауты/ретраи                                                    | timeout 3s; retries ≤ 2                         | интеграционный тест               | api       | Low       |
| NFR-12 | Ротация секретов                  | Регламент и автоматизация                                                 | rotation ≤ 30 дней                              | policy + чек-лист                 | platform  | Medium    |
